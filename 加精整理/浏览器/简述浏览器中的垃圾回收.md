Tag:无法追问

## 核心

**ESP指针影响执行上下文、V8垃圾回收器、回收存在问题以及结果方式。**
## **ESP指针影响执行上下文**
JavaScript在执行两个函数的时候，在执行完成第一个函数以后，ESP指针会移动到第二个函数。这个时候，第一个函数的内存空间被保留，当出现第三个函数再执行的时候，就会覆盖掉第一个函数的内存空间。
## V8垃圾回收器
1. **代际假说**
- 有些对象存在时间非常短
- 不死对象，有些对象存活时间很长
2. **回收流程**
- 标记
- 回收非活动对象
- 内存碎片整理
3. **V8回收器**
- 新生代区（副垃圾回收器）
  - 分配小对象
  - 算法：Scavenge划分两个区域： 对象区域，空闲区域。执行时候将对象放在对象区域，将其活动对象标记。当对象区域快要存满，进行一次垃圾回收。将对象区域的活动对象复制一份到空闲区域，并且排序。接着将空闲区域和对象区域互换，完成回收。
- 老生代区（主垃圾回收器）
  - 对象晋升：被新生代区回收两次还存活的对象提升到老生代区。
  - 标记（递归遍历） —> 清除： 从一组根元素遍历，能访问到的标记成活动对象，访问不到标记成非活动对象。
  - 标记整理算法： 在垃圾回收完成以后，将间隔的内存空间往两侧移动。
4. **回收存在问题**
- 全停顿：JavaScript执行在主线程，回收垃圾暂停其他操作，这就是全停顿。
**解决办法**
- 将回收垃圾任务拆分成多个小任务，穿插在其他的JavaScript任务中执行。